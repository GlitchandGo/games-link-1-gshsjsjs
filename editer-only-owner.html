<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>GitHub Repo Admin Panel + Status Check</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
body { font-family: system-ui, sans-serif; margin: 1rem; }
fieldset { margin-bottom: 1rem; padding: 1rem; border: 1px solid #ccc; }
label { display:block; margin-top: .5rem; font-weight: 600; }
input { width: 100%; max-width: 30rem; padding: .4rem; }
button { margin-top: .6rem; padding: .4rem .8rem; }
.log { border: 1px solid #ccc; padding: .5rem; font-family: monospace; white-space: pre-wrap; height: 10rem; overflow-y: auto; }
.ok { color: green; }
.err { color: red; }
pre { background: #f7f7f7; padding: .5rem; border-radius: .25rem; overflow-x: auto; }
</style>

<script>
  function checkCookie() {
    const cookies = document.cookie.split("; ").map(c => c.trim());
    const accessCookie = cookies.find(c => c.startsWith("access="));
    const accessValue = accessCookie ? accessCookie.split("=")[1] : null;

    if (accessValue !== "1") {
      // Fully replace document with white background and 404 iframe
      document.documentElement.innerHTML = `
        <head>
          <title>404</title>
          <meta charset="UTF-8">
          <meta name="viewport" content="width=device-width, initial-scale=1.0">
          <style>
            html, body {
              margin: 0;
              padding: 0;
              background: white !important;
              overflow: hidden;
              height: 100%;
              width: 100%;
            }
            iframe {
              position: fixed;
              top: 0;
              left: 0;
              width: 100vw;
              height: 100vh;
              border: none;
              background: white !important;
              z-index: 999999;
              display: block;
            }
          </style>
        </head>
        <body>
          <iframe src="/404.html"></iframe>
        </body>
      `;
      setTimeout(() => {
        window.location.href = "/404.html";
      }, 2500);
      return;
    }
  }

  // Run immediately
  checkCookie();

  // Random recheck between 10–25 seconds
  function scheduleNextCheck() {
    const next = Math.floor(Math.random() * (25000 - 10000 + 1)) + 10000;
    setTimeout(() => {
      checkCookie();
      scheduleNextCheck();
    }, next);
  }

  scheduleNextCheck();
</script>

</head>
<body>
<h1>GitHub Repo Admin Panel</h1>

<fieldset>
<legend>Access</legend>
<label>Personal Access Token</label>
<input id="token" type="password" placeholder="Token with repo admin + pages scopes">
</fieldset>

<fieldset>
<legend>Target Repo</legend>
<label>Owner/Repo or URL</label>
<input id="repo" type="text" placeholder="e.g. octocat/Hello-World">
<button id="checkStatus">Check Status</button>
</fieldset>

<fieldset>
<legend>Status</legend>
<pre id="statusBox">— no data —</pre>
</fieldset>

<fieldset>
<legend>Visibility</legend>
<button id="makePrivate">Make Private</button>
<button id="makePublic">Make Public</button>
</fieldset>

<fieldset>
<legend>Pages</legend>
<button id="enablePages">Enable Pages (main / root)</button>
<label>Custom Domain</label>
<input id="customDomain" type="text">
<button id="setDomain">Set Domain</button>
<button id="disablePages">Disable Pages</button>
</fieldset>

<fieldset>
<legend>Repo Details</legend>
<label>Rename Repo</label>
<input id="newName" type="text">
<button id="rename">Rename</button>

<label>Transfer To</label>
<input id="transferTo" type="text">
<button id="transfer">Transfer</button>
</fieldset>

<fieldset>
<legend>Log</legend>
<div id="log" class="log"></div>
</fieldset>

<fieldset>
<legend>File Editor</legend>
<div style="display:flex; gap:1rem; align-items:flex-start;">
  <div style="min-width:220px; max-width:320px;">
    <label>Files in Workspace</label>
    <ul id="fileList" style="list-style:none; padding:0; border:1px solid #ccc; min-height:200px; max-height:400px; overflow:auto;"></ul>
    <button id="downloadAll" style="margin-top:1rem;">Download Everything (ZIP, includes all files & settings)</button>
  </div>
  <div style="flex:1;">
    <label>File Content</label>
    <textarea id="fileContent" style="width:100%; height:320px; font-family:monospace; font-size:1rem; margin-bottom:.5rem;"></textarea>
    <div>
      <button id="saveFile">Save</button>
      <span id="fileStatus"></span>
    </div>
  </div>
</div>
</fieldset>


</body>
</html>
