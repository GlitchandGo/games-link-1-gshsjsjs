<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MAC Code Checker</title>
    <link rel="stylesheet" href="style.css">
    <style>
        body { font-family: Arial, sans-serif; background: #f9f9f9; }
        #container { background: #fff; border-radius: 8px; box-shadow: 0 2px 8px #0001; padding: 2em; max-width: 400px; margin: 3em auto; }
        input, button { width: 100%; margin-bottom: 1em; padding: 0.7em; font-size: 1em; }
        #result { min-height: 1.5em; font-weight: bold; }
        #mac-display { font-family: monospace; font-size: 1.1em; color: #007bff; margin-bottom: 1em; }
    </style>
</head>
<body>
    <div id="container">
        <h2>MAC Code Checker</h2>
        <p>This tool shows your device's MAC code and checks if it is banned on Code Universe.</p>
        <div id="mac-display"></div>
        <button id="check-mac">Check My Device</button>
        <div id="result"></div>
        <hr>
        <label for="mac-input">Or enter a MAC code to check:</label>
        <input type="text" id="mac-input" placeholder="Enter MAC code...">
        <button id="check-input-mac">Check Entered MAC Code</button>
        <div id="input-result"></div>
    </div>
    <script>
    let BACKEND_URL = '';
    fetch('/backend.json')
        .then(res => res.json())
        .then(cfg => {
            BACKEND_URL = cfg.url.replace(/\/$/, '');
            setupMacChecker();
        });
    function getOrCreateMacCode() {
        let code = localStorage.getItem('mac_code');
        if (!code) {
            // Use a hash of userAgent, platform, screen, timezone, language, colorDepth, deviceMemory, hardwareConcurrency, vendor, maxTouchPoints
            const raw = [
                navigator.userAgent,
                navigator.platform,
                screen.width + 'x' + screen.height,
                Intl.DateTimeFormat().resolvedOptions().timeZone || '',
                navigator.language || '',
                screen.colorDepth,
                navigator.deviceMemory || '',
                navigator.hardwareConcurrency || '',
                navigator.vendor || '',
                navigator.maxTouchPoints || ''
            ].join('|');
            // Simple hash to hex
            let hash = 0;
            for (let i = 0; i < raw.length; i++) {
                hash = ((hash << 5) - hash) + raw.charCodeAt(i);
                hash |= 0;
            }
            code = Math.abs(hash).toString(16).padStart(12, '0').slice(0, 12);
            localStorage.setItem('mac_code', code);
        }
        return code;
    }
    function setupMacChecker() {
        const mac = getOrCreateMacCode();
        document.getElementById('mac-display').textContent = 'Your MAC code: ' + mac;
        document.getElementById('check-mac').onclick = function() {
            fetch(BACKEND_URL + '/mac-check', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ mac_code: mac })
            })
            .then(res => res.json())
            .then(data => {
                if (data.banned) {
                    document.getElementById('result').textContent = 'Your device is BANNED.';
                    document.getElementById('result').style.color = 'red';
                } else {
                    document.getElementById('result').textContent = 'Your device is NOT banned.';
                    document.getElementById('result').style.color = 'green';
                }
            })
            .catch(() => {
                document.getElementById('result').textContent = 'Error checking MAC code.';
                document.getElementById('result').style.color = 'red';
            });
        };
        document.getElementById('check-input-mac').onclick = function() {
            const inputMac = document.getElementById('mac-input').value.trim();
            if (!inputMac) {
                document.getElementById('input-result').textContent = 'Please enter a MAC code.';
                document.getElementById('input-result').style.color = 'red';
                return;
            }
            fetch(BACKEND_URL + '/mac-check', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ mac_code: inputMac })
            })
            .then(res => res.json())
            .then(data => {
                if (data.banned) {
                    document.getElementById('input-result').textContent = 'This MAC code is BANNED.';
                    document.getElementById('input-result').style.color = 'red';
                } else {
                    document.getElementById('input-result').textContent = 'This MAC code is NOT banned.';
                    document.getElementById('input-result').style.color = 'green';
                }
            })
            .catch(() => {
                document.getElementById('input-result').textContent = 'Error checking MAC code.';
                document.getElementById('input-result').style.color = 'red';
            });
        };
    }
    </script>
</body>
</html>
